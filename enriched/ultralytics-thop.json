{
  "name": "ultralytics-thop",
  "summary": "Ultralytics THOP package for fast computation of PyTorch model FLOPs and parameters.",
  "language": "python",
  "tags": [
    "math",
    "ml",
    "web"
  ],
  "chunks": [
    {
      "chunk_id": "ultralytics-thop::chunk_0",
      "text": "THOP: PyTorch-OpCounter\n\nWelcome to the [THOP](https://github.com/ultralytics/thop) repository, your comprehensive solution for profiling [PyTorch](https://pytorch.org/) models by computing the number of Multiply-Accumulate Operations (MACs) and parameters. Developed by Ultralytics, this tool is essential for [deep learning](https://www.ultralytics.com/glossary/deep-learning-dl) practitioners aiming to evaluate model efficiency and performance, crucial aspects discussed in our [model training tips guide](https://docs.ultralytics.com/guides/model-training-tips/).\n\n(https://github.com/ultralytics/thop/actions/workflows/format.yml)\n(https://discord.com/invite/ultralytics)\n(https://community.ultralytics.com/)\n(https://reddit.com/r/ultralytics)\n\nDescription\n\nTHOP offers an intuitive API designed to profile PyTorch models by calculating the total number of MACs and parameters. This functionality is vital for assessing the computational efficiency and memory footprint of deep learning models, helping developers optimize performance for deployment, especially on [edge devices](https://www.ultralytics.com/glossary/edge-ai). Understanding these metrics is key to selecting the right model architecture, a topic explored in our [model comparison pages](https://docs.ultralytics.com/compare/).\n\nInstallation\n\nGet started with THOP quickly by installing it via pip:\n\n(https://pypi.org/project/ultralytics-thop/) (https://clickpy.clickhouse.com/dashboard/ultralytics-thop) (https://pypi.org/project/ultralytics-thop/)\n\nAlternatively, for the latest features and updates, install directly from the GitHub repository:\n\nThis ensures you have the most recent version, incorporating the latest improvements and bug fixes.\n\nÔ∏è How to Use\n\nBasic Usage\n\nProfiling a standard PyTorch model like [ResNet50](https://docs.pytorch.org/vision/main/models/generated/torchvision.models.resnet50.html) is straightforward. Import the necessary libraries, load your model and a sample input tensor, then use the `profile` function:\n\nDefine Custom Rules for Third-Party Modules\n\nIf your model includes custom or third-party modules not natively supported by THOP, you can define custom profiling rules using the `custom_ops` argument. This allows for accurate profiling even with complex or non-standard architectures, which is useful when working with models like those found in the [Ultralytics models section](https://docs.ultralytics.com/models/).\n\nImprove Output Readability\n\nFor clearer and more interpretable results, use the `thop.clever_format` function. This formats the raw MACs and parameter counts into human-readable strings (e.g., GigaMACs, MegaParams). This formatting helps in quickly understanding the scale of computational resources required, similar to the metrics provided in our [Ultralytics YOLOv8 documentation](https://docs.ultralytics.com/models/yolov8/).\n\nResults of Recent Models\n\nThe table below showcases the parameters and MACs for several popular [computer vision](https://www.ultralytics.com/glossary/computer-vision-cv) models, profiled using THOP. These benchmarks provide a comparative overview of model complexity and computational cost. You can reproduce these results by running the script located at `benchmark/evaluate_famous_models.py` in this repository. Comparing these metrics is essential for tasks like selecting models for [object detection](https://www.ultralytics.com/glossary/object-detection) or [image classification](https://www.ultralytics.com/glossary/image-classification). For more comparisons, see our [model comparison section](https://docs.ultralytics.com/compare/).\n\nModel\n----------------\nalexnet\nvgg11\nvgg11_bn\nvgg13\nvgg13_bn\nvgg16\nvgg16_bn\nvgg19\nvgg19_bn\nresnet18\nresnet34\nresnet50\nresnet101\nresnet152\nwide_resnet101_2\nwide_resnet50_2\n\nModel\n------------------\nresnext50_32x4d\nresnext101_32x8d\ndensenet121\ndensenet161\ndensenet169\ndensenet201\nsqueezenet1_0\nsqueezenet1_1\nmnasnet0_5\nmnasnet0_75\nmnasnet1_0\nmnasnet1_3\nmobilenet_v2\nshufflenet_v2_x0_5\nshufflenet_v2_x1_0\nshufflenet_v2_x1_5\nshufflenet_v2_x2_0\ninception_v3\n\nContribute\n\nWe actively welcome and encourage community contributions to make THOP even better! Whether it's adding support for new [PyTorch layers](https://docs.pytorch.org/docs/stable/nn.html), improving existing calculations, enhancing documentation, or fixing bugs, your input is valuable. Please see our [Contributing Guide](https://docs.ultralytics.com/help/contributing/) for detailed instructions on how to participate. Together, we can ensure THOP remains a state-of-the-art tool for the [machine learning](https://www.ultralytics.com/glossary/machine-learning-ml) community. Don't hesitate to share your feedback and suggestions!\n\nLicense\n\nTHOP is distributed under the [AGPL-3.0 License](https://www.gnu.org/licenses/agpl-3.0.en.html). This license promotes open collaboration and sharing of improvements. For complete details, please refer to the [LICENSE](https://github.com/ultralytics/thop/blob/main/LICENSE) file included in the repository. Understanding the license is important before integrating THOP into your projects, especially for commercial applications which may require an [Enterprise License](https://www.ultralytics.com/license).\n\nContact\n\nEncountered a bug or have a feature request? Please submit an issue through our [GitHub Issues](https://github.com/ultralytics/thop/issues) page. For general discussions, questions, and community support, join the vibrant Ultralytics community on our [Discord server](https://discord.com/invite/ultralytics). We look forward to hearing from you and collaborating!",
      "word_count": 569
    }
  ]
}